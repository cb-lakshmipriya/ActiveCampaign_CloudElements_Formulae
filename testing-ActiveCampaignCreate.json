{"id":29305,"name":"testing-ActiveCampaignCreate","userId":27893,"accountId":24428,"createdDate":"2019-09-03T05:25:37Z","steps":[{"id":213883,"onSuccess":[],"onFailure":[],"name":"createInstance","type":"script","properties":{"body":"let type = trigger.args.request.query['type'];\nlet thirdPartyElement = trigger.args.request.query['thirdPartyElement'];\nlet siteName = trigger.args.request.query['siteName'];\nlet siteDomain = trigger.args.request.query['siteDomain'];\nlet account = trigger.args.request.query['account'];\nlet apiToken = trigger.args.request.query['apiToken'];\n\naccount = account.substring(8,account.indexOf(\".\"));\n\nlet thirPartyInstanceName = siteName + \".\" + siteDomain + '-activecampaign';\n\nlet body = {\n      name: thirPartyInstanceName,\n      configuration: {\n        \"account\" : account,\n        \"Api-Token\":apiToken\n      },\n      tags: [thirPartyInstanceName,siteName,type]\n    };\n\n\nlet succes = {\n  \"cardStatus\": \"CREATE-INSTANCE-SUCCESS\",\n  \"result\" : body,\n  \"errorInput\":\"account\"\n};\n\n\ndone({\n  statusCode: 200,\n  result: succes\n});\n\n"}},{"id":213884,"onSuccess":[],"onFailure":[],"name":"Error","type":"script","properties":{"body":"let error = {\n  \"cardStatus\": \"CREATE-INSTANCE-FAILED\",\n  \"error\" : \"Invalid inputs\",\n  \"errorInput\":\"account\"\n}\ndone({\n  statusCode: 200,\n  result: error\n})\n"}},{"id":213885,"onSuccess":["createInstance"],"onFailure":["Error"],"name":"validateParams","type":"filter","properties":{"body":"let flag = true;\nif(trigger.args.request.query['account'] === undefined){\n  flag = false;\n}\nif(trigger.args.request.query['apiToken'] === undefined){\n  flag = false;\n}\n\ndone(flag);"}}],"triggers":[{"id":25940,"onSuccess":["validateParams"],"onFailure":[],"type":"manual","async":true,"name":"trigger","properties":{}}],"method":"GET","uri":"/activecampaign/instance","engine":"v1","active":true,"debugLoggingEnabled":true,"singleThreaded":false,"api":"GET /activecampaign/instance","configuration":[]}